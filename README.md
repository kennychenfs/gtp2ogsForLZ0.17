This is forked from Dorus's, I made it support 0.17.  
If you want to change time limit, then rewrite line 503.  
